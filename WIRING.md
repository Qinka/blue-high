# 硬件接线说明

## STM32F103C8T6 引脚映射

### OLED 显示屏 (I2C 接口)

使用 I2C1 外设：

| OLED 引脚 | STM32 引脚 | 功能说明 |
|-----------|-----------|----------|
| VCC       | 3.3V      | 电源正极 |
| GND       | GND       | 电源负极 |
| SCL       | PB6       | I2C 时钟线 |
| SDA       | PB7       | I2C 数据线 |

**注意事项：**
- OLED 显示屏通常使用 SSD1306 控制器
- I2C 地址一般为 0x3C 或 0x3D
- 需要上拉电阻（通常模块自带）
- 电压为 3.3V，不要连接 5V

### E22-400M30S LoRa 模块 (UART 接口)

使用 USART1 外设：

| E22 引脚  | STM32 引脚 | 功能说明 |
|-----------|-----------|----------|
| VCC       | 3.3V      | 电源正极 |
| GND       | GND       | 电源负极 |
| TXD       | PA10 (RX) | 模块发送，MCU 接收 |
| RXD       | PA9 (TX)  | 模块接收，MCU 发送 |

**注意事项：**
- E22-400M30S 使用 UART 串口通信进行透传
- 默认波特率: 9600 bps
- 工作频段: 410-493 MHz
- 发射功率: 最大 30 dBm (1W)
- 必须连接天线，否则可能损坏模块
- 工作电压为 3.3V (2.3V-5.5V)
- 支持透明传输模式
- 注意当地无线频率法规

## 完整接线图

```
STM32F103C8T6 蓝色开发板
┌──────────────────────────┐
│                          │
│  3.3V ──┬─── OLED VCC    │
│         └─── E22 VCC     │
│                          │
│  GND  ──┬─── OLED GND    │
│         └─── E22 GND     │
│                          │
│  PA9  ────── E22 RXD     │
│  PA10 ────── E22 TXD     │
│                          │
│  PA11 ────── USB D-      │
│  PA12 ────── USB D+      │
│                          │
│  PB6  ────── OLED SCL    │
│  PB7  ────── OLED SDA    │
│                          │
└──────────────────────────┘

USB Type-C <---> PC
```

## 电源要求

- **电源电压**：3.3V（通过 USB 供电或外部稳压器）
- **电流消耗**：
  - STM32F103C8T6: ~10-30mA（运行时）
  - OLED 显示屏: ~20mA
  - LoRa 模块: ~120mA（发射时峰值）
- **建议电源**：能提供至少 200mA 的 3.3V 稳压电源

## ST-Link 连接

用于程序下载和调试：

| ST-Link | STM32F103C8T6 |
|---------|---------------|
| SWDIO   | SWDIO (PA13)  |
| SWCLK   | SWCLK (PA14)  |
| GND     | GND           |
| 3.3V    | 3.3V          |

## 常见问题

### OLED 无显示
1. 检查 I2C 接线是否正确
2. 确认 OLED 电源指示灯是否亮起
3. 检查 I2C 地址是否匹配（0x3C 或 0x3D）
4. 使用 I2C 扫描程序确认设备地址

### LoRa 无法通信
1. 确认天线已正确连接
2. 检查 UART 接线（注意 TX 和 RX 交叉连接）
3. 确认波特率设置正确（默认 9600）
4. 使用串口调试工具测试模块是否正常
5. 确保两个设备的频率和参数设置一致
6. 确保设备之间距离不要太远

### USB 通信问题
1. 确认 USB 线缆支持数据传输（非仅充电线）
2. 检查 PC 是否识别到 USB 设备
3. Windows 用户可能需要安装 USB CDC 驱动
4. 尝试更换 USB 端口或重新插拔
5. 使用设备管理器（Windows）或 `lsusb`（Linux）查看设备状态

### 编程/调试问题
1. 确认 ST-Link 驱动已正确安装
2. 检查 SWDIO 和 SWCLK 连接
3. 确保开发板已正确供电
4. 尝试按下复位按钮后重新连接
